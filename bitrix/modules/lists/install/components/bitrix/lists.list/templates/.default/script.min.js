BX.ListClass=function(){var t=function(t){this.ajaxUrl="/bitrix/components/bitrix/lists.list/ajax.php";this.iblockTypeId=t.iblockTypeId;this.iblockId=t.iblockId;this.sectionId=t.sectionId;this.randomString=t.randomString;this.socnetGroupId=t.socnetGroupId};t.prototype.removeElement=function(t){return t.parentNode?t.parentNode.removeChild(t):t};t.prototype.addToLinkParam=function(t,e,o){if(!t.length){return"?"+e+"="+o}t=BX.util.remove_url_param(t,e);if(t.indexOf("?")!=-1){return t+"&"+e+"="+o}return t+"?"+e+"="+o};t.prototype.showModalWithStatusAction=function(t,e){t=t||{};if(!t.message){if(t.status=="success"){t.message=BX.message("LISTS_LCP_TEMPLATE_STATUS_ACTION_SUCCESS")}else{t.message=BX.message("LISTS_LCP_TEMPLATE_STATUS_ACTION_ERROR")+". "+this.getFirstErrorFromResponse(t)}}var o=BX.create("div",{props:{className:"bx-lists-alert"},children:[BX.create("span",{props:{className:"bx-lists-aligner"}}),BX.create("span",{props:{className:"bx-lists-alert-text"},text:t.message}),BX.create("div",{props:{className:"bx-lists-alert-footer"}})]});var s=BX.PopupWindowManager.getCurrentPopup();if(s){s.destroy()}var n=setTimeout(function(){var t=BX.PopupWindowManager.getCurrentPopup();if(!t||t.uniquePopupId!="bx-lists-status-action"){return}t.close();t.destroy()},2e3);var i=BX.PopupWindowManager.create("bx-lists-status-action",null,{content:o,onPopupClose:function(){this.destroy();clearTimeout(n)},autoHide:true,zIndex:2e3,className:"bx-lists-alert-popup"});i.show();BX("bx-lists-status-action").onmouseover=function(t){clearTimeout(n)};BX("bx-lists-status-action").onmouseout=function(t){n=setTimeout(function(){var t=BX.PopupWindowManager.getCurrentPopup();if(!t||t.uniquePopupId!="bx-lists-status-action"){return}t.close();t.destroy()},2e3)}};t.prototype.show=function(t){if(this.getRealDisplay(t)!="none")return;var e=t.getAttribute("displayOld");t.style.display=e||"";if(this.getRealDisplay(t)==="none"){var o=t.nodeName,s=document.body,n;if(displayCache[o]){n=displayCache[o]}else{var i=document.createElement(o);s.appendChild(i);n=this.getRealDisplay(i);if(n==="none"){n="block"}s.removeChild(i);displayCache[o]=n}t.setAttribute("displayOld",n);t.style.display=n}};t.prototype.hide=function(t){if(!t.getAttribute("displayOld")){t.setAttribute("displayOld",t.style.display)}t.style.display="none"};t.prototype.getRealDisplay=function(t){if(t.currentStyle){return t.currentStyle.display}else if(window.getComputedStyle){var e=window.getComputedStyle(t,null);return e.getPropertyValue("display")}};t.prototype.modalWindow=function(t){t=t||{};t.title=t.title||false;t.bindElement=t.bindElement||null;t.overlay=typeof t.overlay=="undefined"?true:t.overlay;t.autoHide=t.autoHide||false;t.closeIcon=typeof t.closeIcon=="undefined"?{right:"20px",top:"10px"}:t.closeIcon;t.modalId=t.modalId||"lists_modal_window_"+(Math.random()*(2e5-100)+100);t.withoutContentWrap=typeof t.withoutContentWrap=="undefined"?false:t.withoutContentWrap;t.contentClassName=t.contentClassName||"";t.contentStyle=t.contentStyle||{};t.content=t.content||[];t.buttons=t.buttons||false;t.events=t.events||{};t.withoutWindowManager=!!t.withoutWindowManager||false;var e=[];if(t.title){e.push(BX.create("div",{props:{className:"bx-lists-popup-title"},text:t.title}))}if(t.withoutContentWrap){e=e.concat(t.content)}else{e.push(BX.create("div",{props:{className:"bx-lists-popup-content "+t.contentClassName},style:t.contentStyle,children:t.content}))}var o=[];if(t.buttons){for(var s in t.buttons){if(!t.buttons.hasOwnProperty(s)){continue}if(s>0){o.push(BX.create("SPAN",{html:"&nbsp;"}))}o.push(t.buttons[s])}e.push(BX.create("div",{props:{className:"bx-lists-popup-buttons"},children:o}))}var n=BX.create("div",{props:{className:"bx-lists-popup-container"},children:e});t.events.onPopupShow=BX.delegate(function(){if(o.length){firstButtonInModalWindow=o[0];BX.bind(document,"keydown",BX.proxy(this._keyPress,this))}if(t.events.onPopupShow)BX.delegate(t.events.onPopupShow,BX.proxy_context)},this);var i=t.events.onPopupClose;t.events.onPopupClose=BX.delegate(function(){firstButtonInModalWindow=null;try{BX.unbind(document,"keydown",BX.proxy(this._keypress,this))}catch(e){}if(i){BX.delegate(i,BX.proxy_context)()}if(t.withoutWindowManager){delete windowsWithoutManager[t.modalId]}BX.proxy_context.destroy()},this);var a;if(t.withoutWindowManager){if(!!windowsWithoutManager[t.modalId]){return windowsWithoutManager[t.modalId]}a=new BX.PopupWindow(t.modalId,t.bindElement,{content:n,closeByEsc:true,closeIcon:t.closeIcon,autoHide:t.autoHide,overlay:t.overlay,events:t.events,buttons:[],zIndex:isNaN(t["zIndex"])?0:t.zIndex});windowsWithoutManager[t.modalId]=a}else{a=BX.PopupWindowManager.create(t.modalId,t.bindElement,{content:n,closeByEsc:true,closeIcon:t.closeIcon,autoHide:t.autoHide,overlay:t.overlay,events:t.events,buttons:[],zIndex:isNaN(t["zIndex"])?0:t.zIndex})}a.show();return a};t.prototype.performActionBp=function(t,e,o){BX.ajax({method:"POST",dataType:"json",url:this.addToLinkParam(this.ajaxUrl,"action","performActionBp"),data:{iblockTypeId:this.iblockTypeId,iblockId:this.iblockId,sectionId:this.sectionId,workflowId:t,elementId:e,action:o,socnetGroupId:this.socnetGroupId,sessid:BX.bitrix_sessid()},onsuccess:BX.delegate(function(t){if(t.status=="success"){this.showModalWithStatusAction({status:"success",message:t.message});setTimeout("location.reload()",1e3)}else{t.errors=t.errors||[{}];this.showModalWithStatusAction({status:"error",message:t.errors.pop().message})}},this)})};return t}();
//# sourceMappingURL=script.map.js