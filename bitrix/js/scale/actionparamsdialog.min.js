(function(a){if(BX.Scale.ActionParamsDialog)return;BX.Scale.ActionParamsDialog=function(a){this.title=a.title;this.userParams=a.userParams;this.serverHostname=a.serverHostname;this.callback=a.callback;this.context=a.context;this.dialogWindow=null;this.params={};this.requiredParamsEmptyty={};this.startButtonId="butt_action_start";this.startButtonDisabled=false;this.confirmParams={}};BX.Scale.ActionParamsDialog.prototype.show=function(){var a=this.buildContent();BX.Scale.currentActionDialogContext=this;this.dialogWindow=new BX.CDialog({title:this.title,content:a,resizable:false,buttons:[{title:BX.message("SCALE_PANEL_JS_APD_BUT_START"),id:this.startButtonId,name:this.startButtonId,className:"adm-btn-save",action:BX.proxy(this.returnParamsValues,BX.Scale.currentActionDialogContext)},BX.CAdminDialog.btnCancel]});BX.addCustomEvent(this.dialogWindow,"onWindowClose",function(a){a.DIV.parentNode.removeChild(a.DIV)});if(!BX.Scale.isObjEmpty(this.requiredParamsEmptyty)){this.disableStartButton()}this.dialogWindow.adjustSizeEx();this.dialogWindow.Show()};BX.Scale.ActionParamsDialog.prototype.buildContent=function(){var a=BX.create("DIV"),t=BX.create("table");for(var e in this.userParams){switch(this.userParams[e].TYPE){case"STRING":case"PASSWORD":this.params[e]=new BX.Scale.ActionsParamsTypes.String(e,this.userParams[e]);if(this.userParams[e].VERIFY_TWICE=="Y"){var i={};for(var s in this.userParams[e])i[s]=this.userParams[e][s];i.NAME+=" ("+BX.message("SCALE_PANEL_JS_APD_2_CONFIRM")+")";this.confirmParams[e]=new BX.Scale.ActionsParamsTypes.String(e+"_confirm",i)}break;case"CHECKBOX":this.params[e]=new BX.Scale.ActionsParamsTypes.Checkbox(e,this.userParams[e]);break;case"DROPDOWN":this.params[e]=new BX.Scale.ActionsParamsTypes.Dropdown(e,this.userParams[e]);break;case"TEXT":this.params[e]=new BX.Scale.ActionsParamsTypes.Text(e,this.userParams[e]);break}if(this.params[e])t.appendChild(this.createParamNodeRaw(this.params[e]));if(this.confirmParams[e])t.appendChild(this.createParamNodeRaw(this.confirmParams[e]))}a.appendChild(t);BX.addCustomEvent("BXScaleActionParamKeyUp",BX.proxy(this.onParamFieldKeyUp,this));return a};BX.Scale.ActionParamsDialog.prototype.createParamNodeRaw=function(a){if(!BX.type.isElementNode(a.domNode))return false;var t=BX.create("tr"),e=BX.create("span",{props:{innerHTML:a.name+": "}});if(a.required!==undefined&&a.required=="Y"){BX.addClass(e,"adm-required-field");if(!a.defaultValue||a.defaultValue.length<=0)this.requiredParamsEmptyty[a.id]=true;else this.requiredParamsEmptyty[a.id]=false}var i=BX.create("td",{style:{textAlign:"right",width:"50%"}});i.appendChild(e);t.appendChild(i);i=BX.create("td",{style:{textAlign:"left",width:"50%"}});i.appendChild(a.domNode);t.appendChild(i);return t};BX.Scale.ActionParamsDialog.prototype.isAllRequiredParamsFilled=function(){var a=true;for(var t in this.requiredParamsEmptyty){if(this.requiredParamsEmptyty[t]){a=false;break}}return a};BX.Scale.ActionParamsDialog.prototype.enableStartButton=function(){this.disableStartButton(true)};BX.Scale.ActionParamsDialog.prototype.disableStartButton=function(a){var t=BX(this.startButtonId);if(t&&t.disabled!==undefined){var e=!a;t.disabled=e;this.startButtonDisabled=e}};BX.Scale.ActionParamsDialog.prototype.onParamFieldKeyUp=function(a){if(this.requiredParamsEmptyty[a.paramId]!==undefined){this.requiredParamsEmptyty[a.paramId]=a.empty;if(this.isAllRequiredParamsFilled()==this.startButtonDisabled)this.disableStartButton(this.startButtonDisabled)}this.addSitePatch(a)};BX.Scale.ActionParamsDialog.prototype.returnParamsValues=function(){var a={},t,e;for(var i in this.params){t=this.params[i].getValue();if(this.confirmParams[i]){e=this.confirmParams[i].getValue();if(t!=e){var s=BX.message("SCALE_PANEL_JS_APD_2_NOT_CONCIDE");s=s.replace("##FIELD1##",this.params[i].name);s=s.replace("##FIELD2##",this.confirmParams[i].name);BX.Scale.AdminFrame.alert(s,BX.message("SCALE_PANEL_JS_WARNING"));return false}}a[i]=t}this.dialogWindow.Close();if(typeof this.callback=="function")this.callback.call(this.context,{userParams:a,serverHostname:this.serverHostname});return a};BX.Scale.ActionParamsDialog.prototype.addSitePatch=function(a){if(a.paramId!=="SITE_NAME")return;var t=BX("action_user_param_SITE_NAME").value;BX("action_user_param_SITE_PATH").value=t}})(window);
//# sourceMappingURL=actionparamsdialog.map.js