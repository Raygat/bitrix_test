StateMachineWorkflowActivity=function(){var e=new BizProcActivity;e.classname="StateMachineWorkflowActivity";e.Table=null;e.__l=[];e.SerializeStateMachineWorkflowActivity=e.Serialize;e.Serialize=function(){if(e.childActivities.length>0)e.Properties["InitialStateName"]=e.childActivities[0]["Name"];return e.SerializeStateMachineWorkflowActivity()};e.LineMouseOver=function(e){var t=this.id;t=t.substring(0,t.length-2);for(var i=1;i<=3;i++){var l=document.getElementById(t+"."+i);l.style.backgroundColor="#ee0000";l.style.zIndex=parseInt(l.style.zIndex)+1e3}};e.LineMouseOut=function(e){var t=this.id;t=t.substring(0,t.length-2);for(var i=1;i<=3;i++){var l=document.getElementById(t+"."+i);l.style.backgroundColor="#afb8d2";l.style.zIndex=parseInt(l.style.zIndex)-1e3}};e.DrawLines=function(){var t,i;for(t=0;t<e.__l.length;t++)for(i=0;i<e.__l[t].length;i++)e.__l[t][i].parentNode.removeChild(e.__l[t][i]);e.__l=[];e.StatusArrows=[];e.FindSetState(false,e);var l=e.StatusArrows;for(t=0;t<l.length;t++){var o=ActGetRealPos(document.getElementById(l[t][0]));var s=ActGetRealPos(document.getElementById(l[t][1]));if(o===false||s===false||o["left"]<=0||s["left"]<=0)continue;var r=e.Table.parentNode;var a=r.appendChild(document.createElement("IMG"));a.style.position="absolute";a.style.zIndex=14+t*10;a.width="8";a.height="8";var n=r.appendChild(document.createElement("IMG"));n.style.position="absolute";n.style.zIndex=15+t*10;n.width="8";n.height="8";var c=r.appendChild(document.createElement("DIV"));c.style.position="absolute";c.style.backgroundColor="#afb8d2";c.style.zIndex=11+t*10;c.style.height="2px";c.id=l[t][0]+"-"+l[t][1]+".1";c.onmouseover=e.LineMouseOver;c.onmouseout=e.LineMouseOut;var p=r.appendChild(document.createElement("DIV"));p.style.position="absolute";p.style.backgroundColor="#afb8d2";p.style.zIndex=12+t*10;p.style.width="2px";p.id=l[t][0]+"-"+l[t][1]+".2";p.onmouseover=e.LineMouseOver;p.onmouseout=e.LineMouseOut;var d=r.appendChild(document.createElement("DIV"));d.style.position="absolute";d.style.backgroundColor="#afb8d2";d.style.zIndex=13+t*10;d.style.height="2px";d.id=l[t][0]+"-"+l[t][1]+".3";d.onmouseover=e.LineMouseOver;d.onmouseout=e.LineMouseOut;var h=d.appendChild(document.createElement("IMG"));h.width="1";h.height="1";h=c.appendChild(document.createElement("IMG"));h.width="1";h.height="1";o["right"]=o["right"]+10;o["left"]=o["left"]-10;var f,u=t*6-50,y=12;if(o["right"]<s["left"]){f=s["left"]-o["right"];c.style.left=o["right"]+"px";c.style.width=f/2+u+"px";p.style.left=o["right"]+f/2+u+"px";d.style.left=o["right"]+f/2+u+"px";a.src="/bitrix/images/bizproc/arr_l1.gif";a.style.left=o["right"]-2+"px";a.style.top=o["top"]+y-3+"px";n.src="/bitrix/images/bizproc/arr_r1.gif";n.style.left=s["left"]+"px";n.style.top=s["top"]+y-3+"px"}else if(o["left"]==s["left"]){f=150;c.style.left=o["left"]-f/2+u+"px";c.style.width=f/2-u+"px";p.style.left=o["left"]-f/2+u+"px";d.style.left=o["left"]-f/2+u+"px";a.src="/bitrix/images/bizproc/arr_l2.gif";a.style.left=o["left"]-6+"px";a.style.top=o["top"]+y-3+"px";n.src="/bitrix/images/bizproc/arr_r1.gif";n.style.left=s["left"]+"px";n.style.top=s["top"]+y-3+"px"}else{f=o["left"]-s["right"];c.style.left=s["right"]+f/2-u+"px";c.style.width=f/2+u+"px";p.style.left=s["right"]+f/2-u+"px";d.style.left=s["right"]+"px";a.src="/bitrix/images/bizproc/arr_r2.gif";a.style.left=o["left"]-6+"px";a.style.top=o["top"]+y-3+"px";n.src="/bitrix/images/bizproc/arr_l2.gif";n.style.left=s["right"]-8+"px";n.style.top=s["top"]+y-3+"px"}c.style.top=o["top"]+y+"px";if(o["top"]<s["top"]){p.style.top=o["top"]+y+"px";p.style.height=s["top"]-o["top"]+"px"}else{p.style.top=s["top"]+y+"px";p.style.height=o["top"]-s["top"]+"px"}d.style.top=s["top"]+Math.floor((s["bottom"]-s["top"])/2)+"px";d.style.width=f/2-u+2+"px";e.__l.push([a,c,p,d,n])}};e.FindSetState=function(t,i){if(i.Type=="SetStateActivity"){if(i.Properties["TargetStateName"])e.StatusArrows.push([t,i.Properties["TargetStateName"]])}else{for(var l=0;l<i.childActivities.length;l++){if(i.Type=="StateActivity")t=i.childActivities[l].Name;e.FindSetState(t,i.childActivities[l])}}};e.Draw=function(t){e.statediv=t;e.Table=t.appendChild(_crt(e.childActivities.length+1,3));e.Table.onresize=function(){};var i,l;for(i=0;i<e.childActivities.length;i++){e.Table.rows[i].cells[0].align="right";e.Table.rows[i].cells[2].align="left";e.childActivities[i].Draw(e.Table.rows[i].cells[i%2*2])}i=e.childActivities.length;e.Table.rows[i].cells[0].align="right";e.Table.rows[i].cells[0].width="350px";e.Table.rows[i].cells[1].width="150px";e.Table.rows[i].cells[2].align="left";var o=jsUtils.CreateElement("INPUT",{type:"button",value:BPMESS["STM_ADD_STATUS"]});o.style.marginBottom="20px";e.Table.rows[i].cells[i%2*2].appendChild(o);e.Table.rows[i].cells[(i+1)%2*2].innerHTML="&nbsp";o.onclick=e.AddStatus;e.ReCheckPosition(true)};e.AddStatus=function(t){var i=e.childActivities.length;var l=CreateActivity("StateActivity");e.childActivities.push(l);l.parentActivity=e;l.Draw(e.Table.rows[i].cells[i%2*2]);var o=e.Table.insertRow(-1);o.insertCell(-1).align="right";o.insertCell(-1).align="center";o.insertCell(-1).align="left";i++;e.Table.rows[i].cells[i%2*2].appendChild(this);l.Settings()};e.RemoveChildStateMachine=e.RemoveChild;e.RemoveChild=function(t){e.RemoveChildStateMachine(t);e.Table.parentNode.removeChild(e.Table);e.Draw(e.statediv)};e.RemoveResourcesActivity=e.RemoveResources;e.RemoveResources=function(){e.RemoveResourcesActivity();if(e.Table){e.Table.parentNode.removeChild(e.Table);e.Table=null}};e.ReCheckPosition=function(t){if(e.Table.style.display=="none")return;var i=ActGetRealPos(e.Table);if(t||e.__lpos!=i["left"]||e.__rpos!=i["right"]){e.__lpos=i["left"];e.__rpos=i["right"];e.DrawLines()}setTimeout(function(){e.ReCheckPosition.call(e)},1e3)};return e};
//# sourceMappingURL=statemachineworkflowactivity.map.js