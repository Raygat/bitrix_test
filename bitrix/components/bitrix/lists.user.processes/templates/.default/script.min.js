BX.namespace("BX.Lists");BX.Lists.ListsProcessesClass=function(){var s=function(s){this.ajaxUrl="/bitrix/components/bitrix/lists.user.processes/ajax.php"};s.prototype.showProcesses=function(s){var t=BX("bx-lists-store_items"),e=[],i=BX.findChildren(t,{tag:"span",className:"feed-add-post-form-link-lists"},true);if(i.length){e=this.getMenuItems(i);this.showMoreMenuLists(e)}else{var a=null,r=null;if(BX("bx-lists-select-site-id")){a=BX("bx-lists-select-site-id").value}if(BX("bx-lists-select-site")){r=BX("bx-lists-select-site").value}BX.Lists.ajax({method:"POST",dataType:"json",url:BX.Lists.addToLinkParam(this.ajaxUrl,"action","showProcesses"),data:{siteDir:r,siteId:a,sessid:BX.bitrix_sessid()},onsuccess:BX.delegate(function(s){if(s.status=="success"){for(var a in s.lists){t.appendChild(BX.create("span",{attrs:{"data-name":s.lists[a].name,"data-picture":s.lists[a].picture,"data-url":'document.location.href = "'+s.lists[a].url+'"'},props:{className:"feed-add-post-form-link-lists",id:"bx-lists-tab-create-processes"},style:{display:"none"}}))}i=BX.findChildren(t,{tag:"span",className:"feed-add-post-form-link-lists"},true);e=this.getMenuItems(i);this.showMoreMenuLists(e)}else{s.errors=s.errors||[{}];BX.Lists.showModalWithStatusAction({status:"error",message:s.errors.pop().message})}},this)})}};s.prototype.getMenuItems=function(s){var t=[];for(var e=0;e<s.length;e++){t.push({tabId:"lists",text:s[e].getAttribute("data-name"),className:"feed-add-post-form-lists",onclick:s[e].getAttribute("data-url")})}return t};s.prototype.showMoreMenuLists=function(s){var t=BX.PopupMenu.create("lists",BX("bx-lists-create-processes"),s,{closeByEsc:true,offsetTop:5,offsetLeft:12,angle:true});var e=BX.findChildren(BX("popup-window-content-menu-popup-lists"),{tag:"span",className:"menu-popup-item-icon"},true),i=BX.findChildren(BX("bx-lists-store_items"),{tag:"span",className:"feed-add-post-form-link-lists"},true);for(var a=0;a<e.length;a++){e[a].innerHTML=i[a].getAttribute("data-picture")}t.popupWindow.show()};return s}();
//# sourceMappingURL=script.map.js